define("service/auth/account",["exports","service/portal","@mail/features","cfg"],function(exports,a,b,c){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var d=g(a);var e=g(b);var f=g(c);function g(a){return a&&a.__esModule?a:{default:a}}function h(a){window.location.href=a+("?page="+encodeURIComponent(window.location.href))+"&allow_external=1"}function i(a){var b=e.default.has("disable-choice");var c=f.default.get("urls.loginUrl")||"https://account.mail.ru/login";if(b){h(c);return}d.default.load().then(function(){a=Object.assign({page:location.protocol+"//"+location.host,allow_external:true,modal:false,opener:"octavius",mode:"simple",lang:"ru_RU"},a);var b=__PH.authForm;if(!b.isVisible()){if(app&&app.isReady){if(a.modal){document.body.style.overflow="hidden"}b.show(a)}else{h(c);return}}})}function j(){return i({modal:true,formType:"relogin",email:__PH.activeUser()})}exports.default={login:function a(){return new Promise(function(){return i()})},relogin:function a(){return new Promise(function(){return j()})},keepalive:function a(){d.default.load().then(function(){__PH.on("authLost",function(){return j()});__PH.on("loginRequest",function(){return i()});__PH.on("authChange",function(){location.replace("/inbox")})})}}});